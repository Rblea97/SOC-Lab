# Incident Response Report

| Field | Value |
|-------|-------|
| **Incident ID** | IR-2026-005 |
| **Date** | 2026-02-14 |
| **Analyst** | Richard Blea |
| **Classification** | Persistence — Web Shell |
| **Severity** | High |
| **Status** | Closed — Artifact collected; isolated lab environment |

---

## 1. Executive Summary

On 2026-02-14 at approximately 00:50 UTC, Wazuh's syscheck File Integrity Monitoring (FIM) engine detected the creation of `/tmp/reverse_shell.php` on Kali Defense (192.168.10.12). Custom rule 100003 (*Suspicious file created in /tmp - possible post-exploitation artifact*) fired 71 seconds after the file was written, classifying the event as a potential web shell (MITRE T1505.003). This was a FIM-based detection — not log-based — triggered by Wazuh's realtime inotify monitoring of the `/tmp` directory. Cryptographic hashes of the artifact are preserved below. Containment actions include collecting the file for analysis, verifying no cron jobs or authorized_keys modifications occurred, and checking for active network connections.

---

## 2. Affected Systems

| System | IP | Role |
|--------|----|------|
| Kali Defense | 192.168.10.12 | Host where file was created (Wazuh agent 001) |
| Wazuh Server | 192.168.10.14 | SIEM — FIM detection and alerting |

---

## 3. Timeline

All timestamps are UTC.

| Time (UTC) | Event |
|------------|-------|
| 00:50:42 | `/tmp/reverse_shell.php` created on 192.168.10.12 (file mtime) |
| 00:50:44 | Wazuh syscheck realtime inotify event fires (alert ID 1771030244.74637) |
| 00:50:44 | Rule 100003 triggers — Detection latency: 71 seconds from creation |
| Post-detection | No network connections to port 80/443 from file path observed during lab window |

---

## 4. Technical Analysis

**Detection mechanism:** Wazuh syscheck FIM in **realtime mode** (inotify), monitoring `/tmp`. This is distinct from log-based detection — the alert was generated by the FIM subsystem observing a filesystem `added` event, not by parsing application or auth logs. The 71-second latency reflects the syscheck event queue flush interval, not network roundtrip.

**File characteristics:** The file is 31 bytes — consistent with a minimal PHP reverse shell stub or dropper, not a full web shell framework. The PHP extension in a world-readable file (permissions `664`) in `/tmp` indicates the attacker intended to serve it from a web server process or execute it via a local PHP CLI.

**PHP in `/tmp` significance:** Legitimate web applications do not write PHP files to `/tmp`. The combination of `.php` extension, `/tmp` path, and small file size is a reliable indicator of post-exploitation artifact placement.

**MITRE ATT&CK Mapping:**

| Tactic | Technique |
|--------|-----------|
| Persistence | T1505.003 — Server Software Component: Web Shell |

---

## 5. Evidence

**Artifact:** `evidence/scenario-05-suspicious-file/result.json`

**File path:** `/tmp/reverse_shell.php`

**Artifact Hash Table:**

| Algorithm | Hash |
|-----------|------|
| MD5 | `fc023fcacb27a7ad72d605c4e300b389` |
| SHA1 | `f16d1122d450c92e85174c1984c70c2d6e4bdeb3` |
| SHA256 | `ac5b099b97c6536012276c5e61c50d4f4fe6fd606bd861c5c15f769153452e68` |

**Key alert fields:**

| Field | Value |
|-------|-------|
| Timestamp | 2026-02-14T00:50:44.947+0000 |
| Rule ID | 100003 |
| Rule Level | 10 (High) |
| Fired Times | 1 |
| Agent ID | 001 |
| Agent Name | kali |
| Agent IP | 192.168.10.12 |
| File Path | /tmp/reverse_shell.php |
| File Size | 31 bytes |
| Permissions | rw-rw-r-- (664) |
| UID / GID | 1000 / 1000 (kali) |
| Inode | 25 |
| Detection Mode | syscheck realtime (inotify) |
| Detection Latency | 71 seconds |
| Decoder | syscheck\_new\_entry |

---

## 6. Containment & Recommendations

1. **Collect before deletion** — Copy `/tmp/reverse_shell.php` to a forensic holding directory (`/root/evidence/`) before removing it from `/tmp`. Preserve hash chain of custody.
2. **Submit hashes to threat intelligence** — Query MD5/SHA1/SHA256 against VirusTotal and internal threat intel platforms to determine if this is a known payload.
3. **Check cron and authorized_keys** — Inspect `crontab -l` (all users), `/etc/cron.d/`, and `/home/kali/.ssh/authorized_keys` for attacker-planted persistence. The 31-byte file may be a stub that downloads a larger payload.
4. **Check active network connections** — Run `ss -tlnp` and `netstat -an` on 192.168.10.12 to identify any listeners on port 80, 443, or non-standard ports that may indicate a running web server process serving the shell.
5. **Audit web server processes** — If Apache, Nginx, or PHP-FPM is running on 192.168.10.12, check access logs for requests to `/tmp/reverse_shell.php` or any PHP file in `/tmp`.
6. **Tune FIM scope** — Confirm `/tmp` is included in syscheck `<directories>` with `realtime="yes"` in `ossec.conf`. Extend monitoring to `/var/www/`, `/var/tmp/`, and user home directories.

---

## 7. Compliance Cross-Reference

| Framework | Control | Requirement |
|-----------|---------|-------------|
| NIST 800-53 | SI-7 | Software, firmware, and information integrity |
| NIST 800-53 | SI-4 | Information system monitoring |
| PCI-DSS | 11.5 | Change detection mechanisms (file integrity monitoring) |
| PCI-DSS | 10.2.7 | Creation and deletion of system-level objects |
| HIPAA | 164.312.c.1 | Integrity controls |
| GDPR | IV_32.2 | Security of processing |
