# Incident Response Report

| Field | Value |
|-------|-------|
| **Incident ID** | IR-2026-003 |
| **Date** | 2026-02-14 |
| **Analyst** | Richard Blea |
| **Classification** | Initial Access — Exploit Public-Facing Application |
| **Severity** | Medium |
| **Status** | Closed — Post-exploitation activity not confirmed |

---

## 1. Executive Summary

On 2026-02-14 at approximately 05:43 UTC, Wazuh detected a PAM authentication failure on MS-2 (192.168.10.13) associated with a local login attempt by user `msfadmin` on tty1. This alert was an indirect indicator of exploitation of CVE-2011-2523 — the vsftpd 2.3.4 backdoor — which opens a root shell on port 6200/TCP when a username ending in `:)` is submitted during FTP authentication. The backdoor shell's local login attempt generated the PAM failure captured by built-in rule 2501. Detection latency was 192 seconds, the longest of all lab scenarios, and the rule level (5 — Medium) may not trigger automatic escalation in a production SOC. A dedicated network-layer rule for port 6200/TCP activity is recommended to close this detection gap.

---

## 2. Affected Systems

| System | IP | Role |
|--------|----|------|
| MS-2 (Metasploitable 2) | 192.168.10.13 | Target host — vsftpd 2.3.4 service |
| Kali Attack | 192.168.10.11 | Attack source (Metasploit framework) |
| Wazuh Server | 192.168.10.14 | SIEM — detection and alerting (agent 000) |

---

## 3. Timeline

All timestamps are UTC.

| Time (UTC) | Event |
|------------|-------|
| ~05:40:47 | FTP authentication attempt with backdoor trigger username (ending `:)`) sent to vsftpd on 192.168.10.13:21 |
| ~05:40:47 | CVE-2011-2523 backdoor activates; root shell opens on port 6200/TCP |
| ~05:40:47 | Backdoor shell attempts local login as `msfadmin` on tty1; PAM generates auth failure |
| 05:43:59 | Wazuh rule 2501 fires — syslog PAM authentication failure (alert ID 1771047839.911254) |
| 05:43:59 | Detection latency: 192s (longest in lab — likely due to syslog flush interval) |

---

## 4. Technical Analysis

**Attack vector:** CVE-2011-2523, a deliberate backdoor introduced into vsftpd 2.3.4 source code. When an FTP username ending in the string `:)` is submitted, the daemon forks a listener shell bound to port 6200/TCP running as root. No FTP password authentication is required.

**Detection mechanism (indirect):** Wazuh built-in rule 2501 (*syslog: User authentication failure.*) captured the PAM failure generated when the backdoor shell attempted a local console login as `msfadmin` on tty1. This is an indirect, after-the-fact indicator — the backdoor was already active by the time detection fired.

**Detection gap:** Rule 2501 at level 5 (Medium) does not alert on the FTP backdoor trigger itself, nor on the port 6200/TCP bind event. In a production environment with automated escalation thresholds set at level 7 or higher, this alert would not page an analyst. A dedicated custom rule for `vsftpd` backdoor patterns or a network-layer IDS signature for port 6200/TCP activity is required to close this gap.

**Full log captured:**
```
login[4875]: pam_unix(login:auth): authentication failure; logname=LOGIN uid=0 euid=0 tty=tty1 ruser= rhost=  user=msfadmin
```

**MITRE ATT&CK Mapping:**

| Tactic | Technique |
|--------|-----------|
| Initial Access | T1190 — Exploit Public-Facing Application |

---

## 5. Evidence

**Artifact:** `evidence/scenario-03-vsftpd/result.json`

**Key alert fields:**

| Field | Value |
|-------|-------|
| Timestamp | 2026-02-14T05:43:59.803+0000 |
| Rule ID | 2501 |
| Rule Level | 5 (Medium) |
| Fired Times | 1 |
| Agent ID | 000 |
| Agent Name | wazuh-server |
| Target Location | 192.168.10.13 |
| Log Source | syslog (tty1) |
| Affected User | msfadmin |
| Detection Latency | 192 seconds |
| Decoder | (syslog built-in) |

---

## 6. Containment & Recommendations

1. **Patch or replace vsftpd** — Remove vsftpd 2.3.4 immediately; upgrade to a patched version or replace with a hardened FTP service. CVE-2011-2523 has a CVSS score of 10.0.
2. **Add dedicated network-layer rule** — Create a Suricata/Snort signature or a custom Wazuh rule detecting any TCP connection to port 6200 on 192.168.10.13. This would have detected the backdoor at bind time rather than 192 seconds later via PAM syslog.
3. **Tune rule 2501 threshold** — Evaluate whether a PAM authentication failure on `tty1` (console, not SSH) warrants escalation to level 7+ given the unusual context. Console login failures are rare on servers.
4. **Audit port 6200/TCP** — Run `ss -tlnp | grep 6200` and check firewall rules on 192.168.10.13 to confirm the backdoor shell is not still active.
5. **Review FTP access logs** — Examine `/var/log/vsftpd.log` for the triggering FTP session to reconstruct the full attack chain and confirm attacker IP and session duration.

---

## 7. Compliance Cross-Reference

| Framework | Control | Requirement |
|-----------|---------|-------------|
| PCI-DSS | 10.2.4 | Invalid logical access attempts |
| PCI-DSS | 10.2.5 | Use of identification and authentication mechanisms |
| NIST 800-53 | AU-14 | Session audit |
| NIST 800-53 | AC-7 | Unsuccessful logon attempts |
| HIPAA | 164.312.b | Audit controls |
| GDPR | IV_35.7.d | Data protection impact assessment |
