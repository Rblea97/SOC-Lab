---
title: "SOC Home Lab — MVP SIEM with Wazuh"
status: FINAL
owner: Richard Blea
created: 2026-02-13
last_updated: 2026-02-13
related_issues: None
testbed_baseline: "CSCY 4743 Testbed (Kali Attack, Kali Defense, MS-2 Target)"
---

# SOC Home Lab: MVP SIEM with Wazuh

## 1. Executive Summary

This specification defines a **minimum viable SOC home lab** that extends the existing CSCY 4743 three-VM cybersecurity testbed into a functional Security Operations Center environment. The MVP adds a dedicated Wazuh SIEM server (4th VM) to collect, correlate, and visualize security events generated by attack simulations against the Metasploitable-2 target, while the two Kali VMs serve as attack source and monitored defense endpoint respectively.

The project targets a **SOC Analyst (Tier 1/2) portfolio audience** and is scoped to demonstrate: log ingestion and normalization, alert triage, custom detection rule authoring, and lightweight Python-based alert enrichment — the core daily skills hiring managers evaluate for junior SOC roles.

The lab is designed as an expandable foundation. The MVP delivers SIEM capability only; IDS/IPS (Snort/Suricata), threat intelligence feeds, and incident response workflows are documented as future phases but explicitly out of scope for this iteration.

## 2. Problem Statement and Motivation

### The Problem

Junior SOC analyst candidates face a credibility gap: job postings require hands-on experience with SIEM platforms, alert triage, and detection engineering, but most candidates can only point to classroom exercises or certificates. "I completed a TryHackMe room" does not differentiate.

### Who Experiences This

Students and early-career candidates targeting SOC Analyst Tier 1/2 roles who need portfolio evidence of practical security operations skills beyond coursework.

### Why Now

The SOC analyst job market in 2025–2026 increasingly filters on demonstrated ability to work with real tooling (Wazuh, Elastic, Splunk) and write detection logic, not just theoretical knowledge. A home lab with documented architecture, custom detection rules, and Python automation scripts is a concrete differentiator that can be shown in interviews and linked from a resume.

### Why This Testbed

The existing CSCY 4743 testbed already provides the attack infrastructure (Kali Attack), a vulnerable target (MS-2), and a defense observation point (Kali Defense). Adding a SIEM server completes the SOC workflow: generate attacks → detect attacks → triage alerts → tune detections.

## 3. Goals

1. **Deploy a working Wazuh SIEM** (server + dashboard + agents) that ingests logs from at least two endpoints (Kali Defense VM and MS-2 Target VM).
2. **Execute at least 5 documented attack scenarios** against MS-2 and confirm each generates a visible, triageable alert in Wazuh.
3. **Author at least 3 custom detection rules** (beyond Wazuh defaults) that detect specific attack patterns from the scenario library.
4. **Build lightweight Python tooling** (alert enrichment and/or rule conversion) that demonstrates engineering judgment beyond "install and configure."
5. **Document the entire lab** with architecture diagrams, a runbook, and a portfolio write-up suitable for linking from a resume or showing in an interview.

## 4. Non-Goals (Explicitly Out of Scope for MVP)

- **IDS/IPS deployment** (Snort, Suricata). Planned for Phase 2.
- **Threat intelligence feed integration** (MISP, OpenCTI, AbuseIPDB). Planned for Phase 3.
- **Incident response / forensics workflows** (memory acquisition, disk imaging, timeline analysis). Planned for Phase 4.
- **SOAR / automated playbooks** (Shuffle, TheHive). Future phase.
- **Multi-tenant or production-grade hardening** of the Wazuh deployment.
- **Cloud deployment** — this is a local-only lab.
- **Windows endpoint monitoring** — MVP focuses on Linux endpoints only.

## 5. Success Metrics and Acceptance Criteria

| Metric | Target | Verification Method |
|---|---|---|
| Wazuh server operational | Dashboard accessible, agents connected | `curl -k https://<wazuh-ip>:443` returns 200; agent list shows 2+ agents |
| Log ingestion working | Events from 2+ endpoints visible in dashboard | Wazuh dashboard → Security Events shows entries from both agent IDs |
| Attack detection | ≥5 attack scenarios produce alerts | Execute each scenario; confirm corresponding alert in Wazuh within 60s |
| Custom rules | ≥3 custom rules deployed and firing | Trigger each rule's condition; confirm alert with correct rule ID |
| Python tooling | ≥1 working script (enrichment or rule conversion) | Script runs without error; output is valid and demonstrably useful |
| Documentation | Architecture diagram + runbook + portfolio write-up | Files exist in repo; write-up is coherent to a non-lab-participant reader |
| Reproducibility | Lab can be rebuilt from docs | A peer (or future you) can follow the runbook and reach a working state |

## 6. Architecture

### 6.1 Updated Testbed Topology

```
+---------------------+
│     Host Machine    │
│  (VirtualBox / UTM) │
+---------------------+
          │
+---------------------+
│  Host-Only Network  │
│  (192.168.10.0/24)  │
+---------------------+
    /    │    │    \
   /     │    │     \
+---------+ +---------+ +---------+ +---------+
│  Kali   │ │  Kali   │ │  MS-2   │ │  Wazuh  │
│ Attack  │ │ Defense │ │ Target  │ │ Server  │
│   VM    │ │   VM    │ │   VM    │ │   VM    │
│  .11    │ │  .12    │ │  .13    │ │  .14    │
+---------+ +---------+ +---------+ +---------+
  │  │          │             │           │
  │  │      [Wazuh Agent] [Wazuh Agent]   │
  │  │          └─────────────┴───────────┘
  │  │                  (agent → server)
  │  │
  │  └── Generates attacks against .13
  └──── Optional NAT (Adapter 2) for updates
```

**IP Addressing Plan (Host-Only Network):**

| VM | IP Address | Role in SOC Lab |
|---|---|---|
| Kali Attack VM | 192.168.10.11 | Adversary simulation (generates attack traffic) |
| Kali Defense VM | 192.168.10.12 | Monitored endpoint + analyst workstation (Wazuh agent) |
| MS-2 Target VM | 192.168.10.13 | Vulnerable target (Wazuh agent via syslog forwarding) |
| Wazuh Server VM | 192.168.10.14 | SIEM server (Wazuh manager + indexer + dashboard) |

### 6.2 Data Flow

```
Attack Source (.11)
    │
    ▼  [exploits, scans, brute force]
MS-2 Target (.13) ──────syslog──────▶ Wazuh Server (.14)
    │                                       ▲
    │                                       │
Kali Defense (.12) ──────wazuh-agent────────┘
    │
    └── Analyst views dashboard on Wazuh Server (.14:443)
```

**Log sources for MVP:**

| Source | Transport | Log Types |
|---|---|---|
| Kali Defense VM | Wazuh agent (direct) | Auth logs, syslog, file integrity events |
| MS-2 Target VM | Syslog forwarding to Wazuh (agent install is unreliable on MS-2's old OS) | Auth logs (`/var/log/auth.log`), service logs, syslog |
| Wazuh Server (self) | Local agent | Self-monitoring (manager health) |

### 6.3 Why a Dedicated 4th VM (Not Running SIEM on Kali Defense)

- **Separation of concerns:** In a real SOC, the SIEM is infrastructure — not colocated with analyst workstations or monitored endpoints. Running Wazuh on the Defense VM conflates the observer with the observed.
- **Resource isolation:** Wazuh (manager + indexer + dashboard) is memory-hungry (~4–6 GB RAM). Mixing it with active Kali tools degrades both.
- **Portfolio credibility:** A 4-VM architecture with dedicated roles is a stronger signal than "I installed everything on one box."
- **Expandability:** When you add Suricata, TheHive, or MISP in future phases, the SIEM VM is already standalone and can integrate cleanly.

### 6.4 Wazuh Server VM Specifications

| Resource | Allocation | Rationale |
|---|---|---|
| OS | Ubuntu 22.04 LTS Server (minimal) | Stable, well-documented, Wazuh-supported |
| RAM | 6 GB (minimum 4 GB) | Wazuh indexer is the memory bottleneck |
| CPU | 2 cores | Sufficient for lab-scale ingestion |
| Disk | 60 GB | Logs + indexer storage for weeks of lab use |
| Network | Adapter 1: Host-Only (.14), Adapter 2: NAT (for installation only, disable after) | Isolation after setup |

## 7. SIEM Platform Selection: Why Wazuh

### Alternatives Considered

| Platform | Strengths | Why Not for MVP |
|---|---|---|
| **Wazuh** (selected) | Free, no ingest limits, purpose-built for security monitoring, includes agent management + FIM + vulnerability detection, active community, increasingly cited in SOC job postings | — |
| Elastic SIEM (ELK) | Flexible, widely used, powerful query language (KQL) | Requires significant manual configuration to get SOC-grade features; detection rules need manual import; higher complexity for MVP |
| Splunk Free | Industry standard name recognition | 500 MB/day ingest limit is crippling for a learning lab; core SOC features require Enterprise license |

### Decision

**Wazuh** delivers the most SOC-relevant functionality with the least configuration overhead for an MVP. It provides out-of-the-box: agent-based endpoint monitoring, file integrity monitoring (FIM), MITRE ATT&CK mapping, vulnerability detection, and a security-focused dashboard — all free. This means the MVP can focus on detection engineering and alert triage rather than infrastructure plumbing.

## 8. Attack Scenario Library (MVP)

Each scenario MUST: (a) be executable from Kali Attack VM, (b) produce observable log entries on the target, (c) generate at least one Wazuh alert, and (d) be documented with exact commands and expected alert output.

### 8.1 MVP Scenarios (Minimum 5)

| # | Scenario | Tool | Target | Expected Wazuh Alert | MITRE ATT&CK |
|---|---|---|---|---|---|
| 1 | Network reconnaissance | SSH loop (15× legacy-KEX attempts — nmap/Hydra cannot negotiate with MS-2) | MS-2 | Rule 100011: 12+ SSH invalid-user attempts from single source in 60s (custom composite) | T1046 — Network Service Discovery |
| 2 | SSH brute force | `hydra -l kali -P /usr/share/wordlists/rockyou.txt.gz ssh://192.168.10.12` | Kali Defense | Rule 5763: Multiple SSH authentication failures | T1110.001 — Brute Force: Password Guessing |
| 3 | Metasploit exploitation | `msfconsole` → vsftpd 2.3.4 backdoor exploit | MS-2 | Syslog anomaly + new session alert (custom rule) | T1190 — Exploit Public-Facing Application |
| 4 | Privilege escalation attempt | Post-exploitation: `sudo -l` and sudo command abuse | Kali Defense | Rule 5402: Successful sudo to root | T1548.003 — Sudo and Sudo Caching |
| 5 | Suspicious file creation | Create a file in `/tmp` matching common webshell patterns | MS-2 / Defense | FIM alert on monitored directory | T1505.003 — Web Shell |

### 8.2 Scenario Documentation Template

Each scenario is documented as:

```markdown
## Scenario N: <Name>

**MITRE ATT&CK:** <Technique ID and name>
**Objective:** What the attacker is trying to achieve
**Prerequisites:** Lab state required before execution

### Attack Steps (from Kali Attack VM)
1. <exact command>
2. <exact command>

### Expected Detection (Wazuh Dashboard)
- Alert Rule ID: <ID>
- Alert Level: <N>
- Description: <what Wazuh reports>
- Time to detect: <expected latency>

### Triage Notes
- True positive indicators: <what confirms this is real>
- False positive considerations: <when this might fire benignly>
- Recommended response: <what a SOC analyst would do>

### Screenshot Evidence
- [ ] Alert visible in Wazuh dashboard
- [ ] Raw log entry captured
```

## 9. Custom Detection Rules

### 9.1 Rule Authoring Strategy

Wazuh uses XML-based custom rules placed in `/var/ossec/etc/rules/local_rules.xml`. Each custom rule MUST:

- Have a unique rule ID in the 100000–109999 range (local rule space)
- Include a descriptive `<description>` field
- Include MITRE ATT&CK mapping via `<mitre>` tags where applicable
- Be tested against the corresponding attack scenario before committing

### 9.2 MVP Custom Rules (Minimum 3)

**Rule 1: Nmap Scan Detection**

Detects multiple connection attempts from a single source IP within a short window, indicating network scanning.

```xml
<group name="local,syslog,ids,">
  <rule id="100001" level="8" frequency="12" timeframe="60">
    <if_matched_sid>5710</if_matched_sid>
    <same_source_ip />
    <description>Possible network scan: multiple connection attempts from single source in 60s</description>
    <mitre>
      <id>T1046</id>
    </mitre>
  </rule>
</group>
```

**Rule 2: Successful Login After Brute Force**

Detects a successful SSH login that follows multiple failed attempts — the signature of a successful brute force.

```xml
<group name="local,syslog,authentication,">
  <rule id="100002" level="12" frequency="8" timeframe="120">
    <if_matched_sid>5716</if_matched_sid>
    <same_source_ip />
    <description>Successful SSH login after multiple failures — possible brute force success</description>
    <mitre>
      <id>T1110.001</id>
    </mitre>
  </rule>
</group>
```

**Rule 3: Suspicious Temporary File Creation**

Detects file creation in monitored directories matching patterns associated with webshells or post-exploitation tooling.

```xml
<group name="local,syscheck,">
  <rule id="100003" level="10">
    <if_sid>554</if_sid>
    <field name="file">/tmp/</field>
    <match>\.php$|\.py$|\.sh$|reverse|shell|payload</match>
    <description>Suspicious file created in /tmp — possible post-exploitation artifact</description>
    <mitre>
      <id>T1505.003</id>
    </mitre>
  </rule>
</group>
```

### 9.3 Rule Testing Protocol

For each custom rule:
1. Deploy the rule to Wazuh server (`local_rules.xml`)
2. Restart Wazuh manager: `sudo systemctl restart wazuh-manager`
3. Execute the corresponding attack scenario
4. Confirm the alert fires in the dashboard within 60 seconds
5. Verify the rule ID, level, and description match expectations
6. Document with screenshot evidence

## 10. Python Tooling (Portfolio Differentiator)

### 10.1 Rationale

Custom Python scripts transform this from "I installed Wazuh" (tutorial-tier) into "I built detection engineering tooling" (portfolio-standout). The scope is deliberately small — the goal is to demonstrate engineering judgment, not build a product.

### 10.2 Python Environment

- **Python version:** 3.11+ (matches CSCY 4743 lab environment expectations)
- **Location:** Repository root `/tools/` directory
- **Dependencies:** Minimal (stdlib-heavy; `requests`, `pyyaml`, `jinja2` where needed)
- **Quality bar:** Type hints on all functions, docstrings, basic pytest tests

### 10.3 MVP Scripts (Build at least 1, ideally 2)

**Script 1: Alert Enrichment — `enrich_alerts.py`**

Polls Wazuh API for recent high-severity alerts, enriches them with contextual information (source IP reputation lookup via AbuseIPDB or local threat list, MITRE technique description), and outputs a formatted triage summary.

```
Purpose: Demonstrate ability to work with SIEM APIs programmatically
Input:  Wazuh API (https://<wazuh-ip>:55000)
Output: Formatted triage report (stdout or JSON file)

Core functions:
  - fetch_alerts(api_url, min_level, time_window) -> list[Alert]
  - enrich_alert(alert: Alert, threat_intel: ThreatDB) -> EnrichedAlert
  - format_triage_report(alerts: list[EnrichedAlert]) -> str
```

**Script 2: Sigma-to-Wazuh Rule Converter — `sigma_convert.py`**

Converts a subset of Sigma detection rules (YAML format) into Wazuh-compatible XML rules. Sigma is a generic signature format for SIEM systems; demonstrating conversion shows understanding of cross-platform detection engineering.

```
Purpose: Demonstrate detection rule portability and format understanding
Input:  Sigma YAML rule file
Output: Wazuh XML rule (stdout or file)

Core functions:
  - parse_sigma_rule(path: Path) -> SigmaRule
  - convert_to_wazuh_xml(rule: SigmaRule, base_id: int) -> str
  - validate_wazuh_rule(xml_str: str) -> bool
```

### 10.4 Python Quality Requirements (Lightweight)

This is lab tooling, not a production service. Quality bar is calibrated accordingly:

| Check | Tool | Threshold |
|---|---|---|
| Formatting | Ruff format | Must pass |
| Linting | Ruff check | Must pass (default rules) |
| Type hints | mypy (basic mode) | All function signatures typed |
| Tests | pytest | ≥1 test per script; happy path + one edge case |
| No hardcoded secrets | Manual review | API keys via environment variables only |

### 10.5 pyproject.toml (for `/tools/` directory)

```toml
[project]
name = "soc-lab-tools"
version = "0.1.0"
description = "Python tooling for SOC home lab"
requires-python = ">=3.11"
dependencies = [
    "requests>=2.31",
    "pyyaml>=6.0",
]

[project.optional-dependencies]
dev = [
    "pytest>=7.4",
    "mypy>=1.5",
    "ruff>=0.4",
]

[tool.ruff]
target-version = "py311"
line-length = 100

[tool.ruff.lint]
select = ["E", "W", "F", "I", "N", "UP", "B"]

[tool.mypy]
python_version = "3.11"
warn_return_any = true
disallow_untyped_defs = true

[tool.pytest.ini_options]
testpaths = ["tests"]
```

## 11. Deployment Runbook

### 11.1 Phase 1: Wazuh Server VM Provisioning

```bash
# 1. Create Ubuntu 22.04 Server VM
#    - VirtualBox: New → Linux → Ubuntu 64-bit → 6GB RAM, 2 CPU, 60GB disk
#    - UTM: Virtualize → Linux → Ubuntu ARM64 ISO → same resources
#    - Network: Adapter 1 = Host-Only (.14), Adapter 2 = NAT (temporary)

# 2. Install Ubuntu Server (minimal install, no GUI)
#    - Set hostname: wazuh-server
#    - Create user: analyst (or your preference)
#    - Enable SSH during install

# 3. Set static IP on Host-Only interface
sudo nano /etc/netplan/00-installer-config.yaml
```

```yaml
network:
  version: 2
  ethernets:
    enp0s3:  # Host-Only adapter — verify interface name with `ip link`
      dhcp4: no
      addresses:
        - 192.168.10.14/24
    enp0s8:  # NAT adapter (temporary, for installation)
      dhcp4: yes
```

```bash
sudo netplan apply

# 4. Verify connectivity
ping 192.168.10.11  # Should reach Kali Attack
ping 192.168.10.13  # Should reach MS-2
```

### 11.2 Phase 2: Wazuh Installation (All-in-One)

For the MVP, use Wazuh's all-in-one installation (manager + indexer + dashboard on a single node). This is appropriate for a lab; production would separate components.

```bash
# Download and run Wazuh install assistant
curl -sO https://packages.wazuh.com/4.9/wazuh-install.sh
curl -sO https://packages.wazuh.com/4.9/config.yml

# Edit config.yml — set node IP to 192.168.10.14
# (Follow Wazuh quickstart docs for current version details)

sudo bash wazuh-install.sh -a

# Installation outputs admin credentials — SAVE THESE
# Access dashboard: https://192.168.10.14:443
```

**Post-install:** Disable the NAT adapter on the Wazuh Server VM (no longer needed; keeps the SIEM isolated).

### 11.3 Phase 3: Agent Deployment

**On Kali Defense VM (.12) — Direct Agent Install:**

```bash
# Add Wazuh repo and install agent
# (Use current Wazuh docs for exact repo setup commands)
# Set WAZUH_MANAGER=192.168.10.14 during install

sudo systemctl enable wazuh-agent
sudo systemctl start wazuh-agent

# Verify on Wazuh dashboard: Management → Agents → should show .12
```

**On MS-2 Target VM (.13) — Syslog Forwarding:**

MS-2 runs an old Ubuntu (8.04-era) where the Wazuh agent may not install cleanly. Use syslog forwarding instead:

```bash
# On MS-2: configure rsyslog to forward to Wazuh
sudo nano /etc/rsyslog.conf

# Add at the end:
*.* @192.168.10.14:514

sudo service rsyslog restart
```

```bash
# On Wazuh Server: ensure syslog listener is enabled
# Edit /var/ossec/etc/ossec.conf, confirm <remote> block includes:
#   <connection>syslog</connection>
#   <port>514</port>
#   <protocol>udp</protocol>

sudo systemctl restart wazuh-manager
```

### 11.4 Phase 4: Configure Monitoring Targets

On the Wazuh server, edit `/var/ossec/etc/ossec.conf` agent configuration (or use centralized config via `shared/agent.conf`):

```xml
<!-- File integrity monitoring -->
<syscheck>
  <directories check_all="yes" realtime="yes">/tmp,/var/www</directories>
  <directories check_all="yes">/etc,/usr/bin,/usr/sbin</directories>
</syscheck>

<!-- Log collection -->
<localfile>
  <log_format>syslog</log_format>
  <location>/var/log/auth.log</location>
</localfile>

<localfile>
  <log_format>syslog</log_format>
  <location>/var/log/syslog</location>
</localfile>
```

### 11.5 Phase 5: Deploy Custom Rules and Validate

1. Copy custom rules to `/var/ossec/etc/rules/local_rules.xml` on Wazuh server
2. Restart manager: `sudo systemctl restart wazuh-manager`
3. Execute each attack scenario from Section 8
4. Confirm alerts in dashboard
5. Capture screenshot evidence for each scenario

## 12. Repository Structure

```
soc-home-lab/
├── README.md                    # Portfolio-facing overview with architecture diagram
├── spec.md                      # This document
├── docs/
│   ├── architecture.md          # Detailed architecture with Mermaid diagrams
│   ├── runbook.md               # Step-by-step deployment guide (from Section 11)
│   ├── attack-scenarios/
│   │   ├── 01-nmap-recon.md
│   │   ├── 02-ssh-brute-force.md
│   │   ├── 03-metasploit-vsftpd.md
│   │   ├── 04-priv-escalation.md
│   │   └── 05-suspicious-file.md
│   └── portfolio-writeup.md     # Resume-linkable summary of the project
├── wazuh-config/
│   ├── local_rules.xml          # Custom detection rules
│   ├── ossec-agent.conf         # Shared agent configuration
│   └── syslog-forwarding.conf   # MS-2 rsyslog config
├── tools/                       # Python tooling
│   ├── pyproject.toml
│   ├── enrich_alerts.py
│   ├── sigma_convert.py
│   └── tests/
│       ├── test_enrich.py
│       └── test_sigma_convert.py
├── evidence/                    # Screenshot evidence of working detections
│   ├── scenario-01-nmap/
│   ├── scenario-02-brute-force/
│   └── ...
└── .github/                     # CI for Python tooling (optional but portfolio-positive)
    └── workflows/
        └── ci.yml
```

## 13. CI Pipeline (for Python Tooling Only)

The lab infrastructure itself is not CI-managed (it's local VMs). The Python tooling in `/tools/` gets a lightweight CI pipeline to demonstrate DevSecOps habits:

```yaml
# .github/workflows/ci.yml
name: ci

on:
  push:
    paths: ['tools/**']
  pull_request:
    paths: ['tools/**']

jobs:
  quality:
    runs-on: ubuntu-latest
    defaults:
      run:
        working-directory: tools
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with:
          python-version: "3.11"

      - name: Install dependencies
        run: pip install -e ".[dev]"

      - name: Lint and format (Ruff)
        run: |
          ruff check .
          ruff format --check .

      - name: Type check (mypy)
        run: mypy .

      - name: Tests (pytest)
        run: pytest
```

## 14. Security Considerations

### 14.1 Lab Isolation

- **Host-Only network is mandatory.** The SIEM, agents, and vulnerable targets MUST remain on the 192.168.10.0/24 isolated network. Bridged mode on any VM (especially MS-2) exposes deliberately vulnerable services to your real network.
- **NAT adapters are temporary.** Enable NAT only for package installation, then disable. The Wazuh Server should have NAT disabled in its final state.
- **MS-2 MUST NEVER have internet access.** It is intentionally vulnerable and will be compromised within minutes on a public network.

### 14.2 Credential Handling

- Wazuh dashboard admin credentials: store in a local password manager, never commit to the repository.
- Wazuh API credentials (for Python tooling): pass via environment variables (`WAZUH_API_USER`, `WAZUH_API_PASSWORD`), never hardcode.
- Default lab credentials (`kali/kali`, `msfadmin/msfadmin`): acceptable for an isolated lab but document that these are lab-only defaults.

### 14.3 Repository Hygiene

- Add a `.gitignore` that excludes: VM disk files, credentials, logs, screenshot originals (keep only curated evidence).
- Include a clear `README.md` disclaimer: "This lab contains intentionally vulnerable systems. Do not expose to production networks."

## 15. Risks, Mitigations, and Tradeoffs

| Risk | Likelihood | Impact | Mitigation |
|---|---|---|---|
| MS-2 syslog forwarding unreliable (old OS, no agent) | Medium | Reduced log fidelity from target | Accept for MVP; document limitation; consider agentless Wazuh monitoring as alternative |
| Wazuh all-in-one uses too much RAM | Low (6GB allocated) | Server sluggish under load | Monitor with `htop`; reduce indexer shard count if needed |
| Custom rules produce false positives | High (expected) | Alert fatigue during demos | Document FP conditions in each rule; tune thresholds iteratively |
| Attack scenarios don't produce expected logs | Medium | Detection rules can't be validated | Test each scenario independently before building rules; have fallback scenarios |
| Python tooling scope creeps beyond MVP | Medium | Delays completion | Hard limit: 2 scripts, each under 200 lines. Anything else goes in "Future Work" |

## 16. Expansion Roadmap (Post-MVP)

This section exists to show hiring managers that you think beyond the current deliverable.

| Phase | Addition | Depends On | New VM? |
|---|---|---|---|
| **Phase 2** | Suricata IDS on Kali Defense VM (network-based detection) | MVP complete | No (runs on .12) |
| **Phase 3** | Threat intel feeds (MISP or OpenCTI) integrated with Wazuh | Phase 2 | Yes (lightweight VM or container) |
| **Phase 4** | Incident response workflow (TheHive + Cortex) | Phase 3 | Yes (or containerized) |
| **Phase 5** | Windows endpoint (add Windows VM with Sysmon + Wazuh agent) | MVP complete | Yes |
| **Phase 6** | SOAR automation (Shuffle) with playbooks | Phase 4 | Container on existing VM |

## 17. Open Questions

1. **Wazuh version pinning:** Should the spec pin a specific Wazuh version (e.g., 4.9.x) or track latest stable? Pinning improves reproducibility; latest gets security patches.
2. **MS-2 agent vs syslog:** Is agentless monitoring (Wazuh's `ossec-remoted` with syslog) sufficient, or should we attempt a custom agent build for MS-2's old Ubuntu?
3. **Portfolio hosting:** Will the portfolio write-up live in the repo only, or also be published (GitHub Pages, personal blog)?
4. **Sigma rule subset:** Which specific Sigma rules are most demonstrable for the converter script? (Suggest: SSH brute force, web shell detection, suspicious process execution.)

## 18. Change History

| Date | Author | Change |
|---|---|---|
| 2026-02-13 | — | Initial draft: MVP scope, Wazuh selection, 4-VM architecture, attack scenarios, Python tooling, deployment runbook |
