<group name="local,syslog,ids,">
  <rule id="100001" level="8" frequency="12" timeframe="60">
    <if_matched_sid>5710</if_matched_sid>
    <same_source_ip />
    <description>Possible network scan: multiple connection attempts from single source in 60s</description>
    <mitre>
      <id>T1046</id>
    </mitre>
  </rule>
</group>

<group name="local,syslog,authentication,">
  <rule id="100002" level="12" frequency="8" timeframe="120">
    <if_matched_sid>5716</if_matched_sid>
    <same_source_ip />
    <description>Successful SSH login after multiple failures - possible brute force success</description>
    <mitre>
      <id>T1110.001</id>
    </mitre>
  </rule>
</group>

<group name="local,syscheck,">
  <rule id="100003" level="10">
    <if_sid>554</if_sid>
    <field name="file">/tmp/</field>
    <match>\.php$|\.py$|\.sh$|reverse|shell|payload</match>
    <description>Suspicious file created in /tmp - possible post-exploitation artifact</description>
    <mitre>
      <id>T1505.003</id>
    </mitre>
  </rule>
</group>

<group name="local,syslog,sshd,authentication_failed,">
  <rule id="100010" level="5">
    <decoded_as>sshd-stripped</decoded_as>
    <match>Invalid user</match>
    <description>SSH invalid user attempt (MS-2 stripped syslog format / T1110.001)</description>
    <mitre>
      <id>T1110.001</id>
    </mitre>
  </rule>

  <rule id="100011" level="8" frequency="12" timeframe="60">
    <if_matched_sid>100010</if_matched_sid>
    <same_source_ip />
    <description>Possible network scan: multiple SSH invalid user attempts from single source in 60s (T1046)</description>
    <mitre>
      <id>T1046</id>
    </mitre>
  </rule>
</group>
